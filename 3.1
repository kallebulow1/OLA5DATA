install.packages("ordinal")
library(ordinal)


data <- read.csv("data/regnskab-ola5.csv", header=TRUE, sep = ";")
data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål.[data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål. == "Dårlig"] <- "Dårlige"
names(data)
unique(data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål.)
data <- data[data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål. != "Ved ikke", ]

# Lav en frekvenstabel
freq <- table(data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål.)

# Søjlediagram
barplot(freq,
        main = "Fordeling af svar: Muligheder for at låne penge til virksomheden",
        xlab = "Svarmulighed",
        ylab = "Antal svar",
        col = "lightblue",
        las = 2)  # roterer labels så de er læsbare

counts <- table(data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål.)
data_svar <- data.frame(
  Svar = names(counts),
  Antal = as.numeric(counts)
)

data_svar
library(ggplot2)
ggplot(data_svar, aes(x = Svar, y = Antal)) +
  geom_col(fill = "steelblue") +
  theme_minimal()

data_svar$Svar <- factor(
  data_svar$Svar,
  levels = c("Meget dårlige", "Dårlige", "Neutrale", "Gode", "Meget gode")
)
ggplot(data_svar, aes(x = Svar, y = Antal)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Fordeling af svar",
    x = "Svar",
    y = "Antal"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 20, hjust = 1))

data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål. <- factor(
  data$Hvordan.ser.du.mulighederne.for.at.låne.penge.til.din.virksomhed...fiktivt.spørgsmål.,
  levels = c("Meget dårlige", "Dårlige", "Neutrale", "Gode", "Meget gode"),
  ordered = TRUE
)
